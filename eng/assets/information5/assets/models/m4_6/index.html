<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="../../css/base.css">
    <link rel="stylesheet" href="css/style.css">
    <title>拓展</title>
</head>

<body>
    <div class="gameBox">
        <div class="lyl">
            <img class="topic" src="images/1.png" alt="">
            <div class="show">
                <div class="drag">
                    <ul>
                        <li class="drop" data-target="1">
                            <img src="images/1_1.png" alt="">
                        </li>
                        <li class="drop" data-target="9">
                            <img src="images/1_2.png" alt="">
                        </li>
                        <li class="drop" data-target="2">
                            <img src="images/1_3.png" alt="">
                        </li>
                        <li class="drop" data-target="3">
                            <img src="images/1_4.png" alt="">
                        </li>
                        <li class="drop" data-target="4">
                            <img src="images/1_5.png" alt="">
                        </li>
                        <li class="drop" data-target="5">
                            <img src="images/1_6.png" alt="">
                        </li>
                        <li class="drop" data-target="6">
                            <img src="images/1_7.png" alt="">
                        </li>
                        <li class="drop" data-target="7">
                            <img src="images/1_8.png" alt="">
                        </li>
                        <li class="drop" data-target="8">
                            <img src="images/1_9.png" alt="">
                        </li>
                    </ul>
                </div>
                <div class="dashed">
                    <div class="dashed_box"></div>
                    <div class="dashed_box"></div>
                    <div class="dashed_box"></div>
                    <div class="dashed_box"></div>
                    <div class="dashed_box"></div>
                    <div class="dashed_box"></div>
                    <div class="dashed_box"></div>
                    <div class="dashed_box"></div>
                    <div class="dashed_box"></div>
                </div>
            </div>

            <!-- <div class="gameBox_btn gameBox_reset">重置</div>
            <div class="gameBox_btn submit">提交</div> -->
            <div class="anniu alltime  chongzhi gameBox_reset">
                <img src="../../pics/btn_b.png" alt="">
                <img src="../../pics/btn_h.png" alt="">
                <img src="../../pics/chongzhi.png" alt="">
            </div>
            <div class="anniu alltime  chongzhi submit">
                <img src="../../pics/btn_b.png" alt="">
                <img src="../../pics/btn_h.png" alt="">
                <img src="../../pics/tijiao.png" alt="">
            </div>


        </div>
    </div>
    <div class="err_model flex" style="display: none;">
        <img src="../../pics/err.png" alt="">
        <audio src="../../audio/err.mp3"></audio>
    </div>
    <div class="right_model flex" style="display: none;">
        <img src="../../pics/right.png" alt="">
        <audio src="../../audio/right.mp3"></audio>
    </div>
</body>
<script src="../../js/jquery.min.js"></script>
<script>
    var rightArr = ["1", "2", "3", "4", "5", "6", "7", "8", "9"]
    var arr = ['','','','','','','','','']
    var selectArr = ['','','','','','','','','']
    var positionArr = {
        left: [0,0,0,0,0,0,0,0,0],
        top: [0,0,0,0,0,0,0,0,0]
    }
    $('.drop').on('mousedown', function (e) {
        var _this = $(this)
        _this.find('div').hide()
        var _left = _this.css('left')
        var _top = _this.css('top')
        var boxOffetLeft = $('.lyl .show').offset().left
        var boxOffetTop = $('.lyl .show').offset().top
        var offsetLeft = _this.offset().left - e.clientX - boxOffetLeft
        var offsetTop = _this.offset().top - e.clientY - boxOffetTop
        var innerWidth = $('.lyl .show').innerWidth()
        var innerHeight = $('.lyl .show').innerHeight()
        var isDown = true
        _this.css('cursor', 'move')
        var centerX = 0
        var centerY = 0
        _this.parents('body').find('.tip').fadeOut()
        _this.find('.err').fadeOut()

        $(window).on('mousemove', function (e) {
            if (isDown == false) {
                return
            }
            var left = offsetLeft + e.clientX
            var top = offsetTop + e.clientY

            _this.css({
                left: left,
                top: top
            })


            centerX = left + _this.width() / 2
            centerY = top + _this.height() / 2

        })
        $(window).on('mouseup', function (e) {
            $(window).off('mousemove mouseup')
            isDown = false
            _this.css('cursor', 'default')
            _target = $('.dashed_box').eq(1) || $('.dashed_box').eq(0) || $('.dashed_box').eq(2)


            for (var i = 0; i < 9; i++) {
                _target = $('.dashed_box').eq(i)
                if (centerX > _target.offset().left - boxOffetLeft
                    && centerX < _target.offset().left - boxOffetLeft + _target.width()
                    && centerY > _target.offset().top - boxOffetTop
                    && centerY < _target.offset().top - boxOffetTop + _target.height() && selectArr[i] == ''
                ) {
                    // right
                    var index = _this.attr('data-target')
                    arr.splice(i,1,index)
                    positionArr.left.splice(i,1,parseInt(_left) / innerWidth * 100 + "%")
                    positionArr.top.splice(i,1,parseInt(_top) / innerHeight * 100 + "%")
                    selectArr.splice(i,1,_this)
                    _this.stop().animate({
                        left: (_target.offset().left - boxOffetLeft + _target.width() / 2 - _this.width() / 2) / innerWidth * 100 + "%",
                        top: (_target.offset().top - boxOffetTop + _target.height() / 2 - _this.height() / 2) / innerHeight * 100 + "%"
                    }, 100)
                    break;
                } else {
                    // err
                    _this.stop().animate({
                        left: parseInt(_left) / innerWidth * 100 + "%",
                        top: parseInt(_top) / innerHeight * 100 + "%"
                    }, 400)
                    
                }
            }
        })

    })
    $('.submit').on('click', function () {
        if (rightArr.toString() === arr.toString()) {
            $('.right_model').fadeIn()
            $('.right_model audio').trigger('play')
        } else {
            $('.err_model').fadeIn()
            $('.err_model audio').trigger('play')
        }
        // reset()
    })
    function reset() {
        for (var i = 0; i < selectArr.length; i++) {
            if(selectArr[i]){
                selectArr[i].stop().animate({
                    left: positionArr.left[i],
                    top: positionArr.top[i]
                }, 400)
            }
            
        }
        positionArr.left = [0,0,0,0,0,0,0,0,0]
        positionArr.top = [0,0,0,0,0,0,0,0,0]
        selectArr = ['','','','','','','','','']
        arr = ['','','','','','','','','']
    }
    $('.gameBox_reset').on('click', function () {
        reset()
    })

    $('.err_model audio').on('ended', function () {
        $(this).parent().delay(1200).fadeOut()
    })
    $('.right_model audio').on('ended', function () {
        $(this).parent().delay(1200).fadeOut()
    })
</script>

</html>